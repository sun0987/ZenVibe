
<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chat Privado Zenvibe</title>
<style>
  body {
    margin: 0;
    font-family: Arial, sans-serif;
    height: 100vh;
    display: flex;
    flex-direction: column;
    background: linear-gradient(to bottom, #cce7ff, #e0ccff);
  }
  #chatContainer {
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: flex-end;
    padding: 10px;
    overflow-y: auto;
  }
  .mensagem {
    max-width: 70%;
    padding: 10px 15px;
    border-radius: 20px;
    margin-bottom: 8px;
    word-wrap: break-word;
    box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    font-size: 0.95rem;
  }
  .usuario {
    align-self: flex-end;
    background: linear-gradient(135deg, #7a5cff, #8f9bff);
    color: white;
    border-bottom-right-radius: 0;
  }
  .ia {
    align-self: flex-start;
    background: #f0f0f0;
    color: #333;
    border-bottom-left-radius: 0;
  }
  #inputContainer {
    display: flex;
    padding: 10px;
    background: #ffffffdd;
    border-top: 1px solid #ccc;
  }
  #inputUsuario {
    flex: 1;
    padding: 12px 15px;
    border-radius: 25px;
    border: 1px solid #aaa;
    outline: none;
    font-size: 1rem;
  }
  #enviarBtn {
    margin-left: 10px;
    padding: 12px 20px;
    border-radius: 25px;
    border: none;
    background: linear-gradient(135deg, #7a5cff, #8f9bff);
    color: white;
    cursor: pointer;
    font-size: 1rem;
    transition: 0.3s;
  }
  #enviarBtn:hover {
    background: linear-gradient(135deg, #6950d8, #7b86e5);
    transform: translateY(-2px);
  }
</style>
</head>
<body>

<div id="chatContainer"></div>

<div id="inputContainer">
  <input type="text" id="inputUsuario" placeholder="Digite sua mensagem...">
  <button id="enviarBtn">Enviar</button>
</div>

<script>
const chatContainer = document.getElementById('chatContainer');
const inputUsuario = document.getElementById('inputUsuario');
const enviarBtn = document.getElementById('enviarBtn');

function criarMensagem(texto, tipo) {
  const div = document.createElement('div');
  div.classList.add('mensagem', tipo);
  div.textContent = texto;
  chatContainer.appendChild(div);
  chatContainer.scrollTop = chatContainer.scrollHeight;
}

async function verificarServidor() {
  try {
    const resposta = await fetch("https://c-rebro-do-zenvibes.onrender.com/ping");
    if (resposta.ok) console.log("Servidor online ✅");
    else console.warn("Servidor respondeu com erro ⚠️");
  } catch (erro) {
    console.error("Não foi possível conectar ao servidor ❌", erro);
  }
}

setInterval(verificarServidor, 60000);
verificarServidor();

async function enviarMensagem() {
  const mensagem = inputUsuario.value.trim();
  if (!mensagem) return;

  criarMensagem(mensagem, 'usuario');
  inputUsuario.value = '';

  try {
    const resposta = await fetch("https://c-rebro-do-zenvibes.onrender.com/chat", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ message: mensagem })
    });

    if (!resposta.ok) throw new Error("Erro na resposta do servidor");

    const data = await resposta.json();
    criarMensagem(data.reply || "Sem resposta da IA.", 'ia');
  } catch (erro) {
    criarMensagem("Erro ao conectar com a IA.", 'ia');
    console.error(erro);
  }
}

enviarBtn.addEventListener('click', enviarMensagem);
inputUsuario.addEventListener('keypress', e => {
  if (e.key === "Enter") enviarMensagem();
});
</script>

</body>
</html>
